# dobzinski-k8s-scripts

Scripts developed for use in Kubernetes.

| Script | Information |
| ----- | ----------- |
| [automated-velero.sh](#automatedvelero) | Script to automate Namespace backups and restores using Velero |
| [cleanup-namespaces-from-list.sh](#cleanupnamespacesfromlist) | Safe cleaning up the Namespace from external list file |


## <a id="automatedvelero" />automated-velero.sh

[Open](./automated-velero.sh)

**About**

Make sure you have the "kubectl" and "velero" binaries installed and exported to the "PATH". You also need to export the KUBECONFIG file.

This script will help you schedule backups using Velero.

You will have three options for creating backups and restoring:
- Using a fixed list of namespaces in the script
- Using an external list of namespaces from a file
- Dynamic namespaces list generated by kubectl

**How to use**

After downloading, open the script file, select the options in the header variables, and change the execution permissions. Use <ins>backup</ins> or <ins>restore</ins> as the first parameter and add a sequential <ins>ID</ins>. I suggest you use the date and time, as well as an ID, since you will likely have more than one backup per day initially. 

```
$ vi automated-velero.sh
$ chmod +x automated-velero.sh
$ ./automated-velero.sh backup 2025112101
$ ./automated-velero.sh restore 2025112101
```


## <a id="cleanupnamespacesfromlist" />cleanup-namespaces-from-list.sh

[Open](./cleanup-namespaces-from-list.sh)

**About**

Make sure you have the "kubectl" binary installed and exported to the "PATH". You also need to export the KUBECONFIG file.

If you need to cleaning up your Kubernetes namespaces, and don't freezing the "Terminating" status, because the Persistente Volume in using, 

This script using an external list of namespaces from a file.

**How to use**

You need to create a new file and insert the namespaces to be deleted on each line. Then, open the script file to add this new external file to the "FILE" variable and remember to change the execution permissions

```
$ vi my-namespace-list
$ vi cleanup-namespaces-from-list.sh
$ chmod +x cleanup-namespaces-from-list.sh
$ ./cleanup-namespaces-from-list.sh
```


